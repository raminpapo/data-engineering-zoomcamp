# Documentation: JsonKStreamJoinsTest.java

## File Metadata

- **Path**: `06-streaming/java/kafka_examples/src/test/java/org/example/JsonKStreamJoinsTest.java`
- **Size**: 2,863 bytes
- **Lines**: 63
- **Extension**: `.java`
- **Last Modified**: 2025-11-15T19:46:38.170125

## Original Source

```java
package org.example;

import org.apache.kafka.clients.consumer.ConsumerConfig;
import org.apache.kafka.common.internals.Topic;
import org.apache.kafka.common.serialization.Serdes;
import org.apache.kafka.streams.*;
import org.example.customserdes.CustomSerdes;
import org.example.data.PickupLocation;
import org.example.data.Ride;
import org.example.data.VendorInfo;
import org.example.helper.DataGeneratorHelper;
import org.junit.jupiter.api.AfterAll;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import javax.xml.crypto.Data;
import java.util.Properties;

import static org.junit.jupiter.api.Assertions.*;

class JsonKStreamJoinsTest {
    private Properties props = new Properties();
    private static TopologyTestDriver testDriver;
    private TestInputTopic<String, Ride> ridesTopic;
    private TestInputTopic<String, PickupLocation> pickLocationTopic;
    private TestOutputTopic<String, VendorInfo> outputTopic;

    private Topology topology = new JsonKStreamJoins().createTopology();
    @BeforeEach
    public void setup() {
        props = new Properties();
        props.setProperty(StreamsConfig.APPLICATION_ID_CONFIG, "testing_count_application");
        props.setProperty(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, "dummy:1234");
        if (testDriver != null) {
            testDriver.close();
        }
        testDriver = new TopologyTestDriver(topology, props);
        ridesTopic = testDriver.createInputTopic(Topics.INPUT_RIDE_TOPIC, Serdes.String().serializer(), CustomSerdes.getSerde(Ride.class).serializer());
        pickLocationTopic = testDriver.createInputTopic(Topics.INPUT_RIDE_LOCATION_TOPIC, Serdes.String().serializer(), CustomSerdes.getSerde(PickupLocation.class).serializer());
        outputTopic = testDriver.createOutputTopic(Topics.OUTPUT_TOPIC, Serdes.String().deserializer(), CustomSerdes.getSerde(VendorInfo.class).deserializer());
    }

    @Test
    public void testIfJoinWorksOnSameDropOffPickupLocationId() {
        Ride ride = DataGeneratorHelper.generateRide();
        PickupLocation pickupLocation = DataGeneratorHelper.generatePickUpLocation(ride.DOLocationID);
        ridesTopic.pipeInput(String.valueOf(ride.DOLocationID), ride);
        pickLocationTopic.pipeInput(String.valueOf(pickupLocation.PULocationID), pickupLocation);

        assertEquals(outputTopic.getQueueSize(), 1);
        var expected = new VendorInfo(ride.VendorID, pickupLocation.PULocationID, pickupLocation.tpep_pickup_datetime, ride.tpep_dropoff_datetime);
        var result = outputTopic.readKeyValue();
        assertEquals(result.key, String.valueOf(ride.DOLocationID));
        assertEquals(result.value.VendorID, expected.VendorID);
        assertEquals(result.value.pickupTime, expected.pickupTime);
    }


    @AfterAll
    public static void shutdown() {
        testDriver.close();
    }
}
```

## High-Level Overview

JAVA file with 63 lines.

## Detailed Analysis

*Detailed analysis not available for this file type.*


## Usage & Examples

*Examples found in source code - see original source above.*


## Dependencies & Related Files

### Imported Modules

- `org.apache.kafka.streams.`
- `org.apache.kafka.common.serialization.Serdes`
- `org.junit.jupiter.api.BeforeEach`
- `org.example.data.VendorInfo`
- `org.apache.kafka.common.internals.Topic`
- `org.example.data.Ride`
- `org.junit.jupiter.api.Test`
- `java.util.Properties`
- `org.junit.jupiter.api.AfterAll`
- `org.apache.kafka.clients.consumer.ConsumerConfig`
- `org.example.data.PickupLocation`
- `javax.xml.crypto.Data`
- `static`
- `org.example.helper.DataGeneratorHelper`
- `org.example.customserdes.CustomSerdes`


## Performance & Security Notes

*No specific performance or security issues detected.*


## Testing & Validation

âœ“ This is a test file


---
*Generated by Repo Book Generator v1.0.0*
