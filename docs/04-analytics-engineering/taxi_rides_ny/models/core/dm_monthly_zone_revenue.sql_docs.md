# Documentation: dm_monthly_zone_revenue.sql

## File Metadata

- **Path**: `04-analytics-engineering/taxi_rides_ny/models/core/dm_monthly_zone_revenue.sql`
- **Size**: 929 bytes
- **Lines**: 29
- **Extension**: `.sql`
- **Last Modified**: 2025-11-15T19:46:38.145124

## Original Source

```sql
{{ config(materialized='table') }}

with trips_data as (
    select * from {{ ref('fact_trips') }}
)
    select 
    -- Revenue grouping 
    pickup_zone as revenue_zone,
    {{ dbt.date_trunc("month", "pickup_datetime") }} as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
```

## High-Level Overview

SQL script containing 0 CREATE statements and 2 SELECT queries.

## Detailed Analysis

*Detailed analysis not available for this file type.*


## Usage & Examples

*No explicit usage examples found in file.*


## Dependencies & Related Files

*No external dependencies detected.*


## Performance & Security Notes

*No specific performance or security issues detected.*


## Testing & Validation

*No test framework detected. Manual testing may be required.*


---
*Generated by Repo Book Generator v1.0.0*
